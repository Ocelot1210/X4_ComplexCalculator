# X4: Foundations ステーション計算機

# 概要
ソフトウェアはX4: Foundations向けのステーション計算機です。

## 主な機能
1. ゲームファイルよりデータを直接抽出
    1. Modのサポート
    1. 今後のバージョンアップへの対応
1. モジュールの兵装も考慮したステーションの建造に必要なウェアの計算
1. 保管庫のウェア割当容量計算
1. 簡単なローカライズ


## 動作確認環境
- .NET Core 3.1 runtime(**必須**)
    - ランタイムのダウンロードは[ここ](https://dotnet.microsoft.com/download/dotnet-core/current/runtime)から行えます。
- Windows10 64bit Version 1903


## 起動方法
1. X4_ComplexCalculatorを起動します。
1. ゲームファイルからデータを抽出します(初回起動時のみ)。
    1. 「X4:Foundations root directory」にX4のインストール先フォルダを選択します。
    1. 言語を選択します。
    1. 「Export」ボタンをクリックします。
    1. エクスポートが終了したら「Close」ボタンをクリックして画面を閉じます。

## 詳細説明
1. メイン画面
    1. メニュー
        1. ファイル(F)
            1. 新規作成 -------- 計画を新規作成します。
            1. 上書き保存 ------ 現在の計画を上書き保存します。
            1. 前を付けて保存 -- 現在の計画を別名で保存します。
            1. 開く --------------- 保存した計画を開きます。
            1. インポート
                1. Station Calclator --- [Station Calclator](http://www.x4-game.com/#/station-calculator)より計画をインポートします
                1. 既存の計画 --------- ゲーム中に保存した建造計画から計画をインポートします
                1. モジュールの装備 ----- ゲーム中に保存したモジュールの装備のプリセットをインポートします
            1. エクスポート
                1. Station Calclator --- [Station Calclator](http://www.x4-game.com/#/station-calculator)へ計画をエクスポートします
        1. レイアウト(L)
            1. レイアウト保存 --- 選択中の作業エリアのレイアウトを保存します。
            1. レイアウト一覧 --- 保存したレイアウトを選択します。
                1. 「💾」ボタンをクリックすると、レイアウトを上書き保存できます。
                1. 「✏」ボタンをクリックすると、レイアウト名を編集できます。
                1. 「🗑」ボタンをクリックすると、レイアウトを削除します。

    1. 計画エリア
        - 作業エリア内の項目は「×」ボタンで非表示にする事ができます。
            - 非表示にした項目は作業エリア上部の「表示(V)」より再表示できます。
        1. モジュール一覧タブ
            - 「テキストを入力して検索」と表示されているテキストボックスに文字列を入力すると、表示されるモジュールの絞り込みが行えます。
            - 「追加」ボタンを押すとモジュール選択画面が表示されます。
            - 「マージ」ボタンを押すと同一モジュールが1レコードに纏められます。
            - 「自動追加」ボタンを押すと不足している製品を生産するモジュールが追加されます。
            - クリック可能なセルは文字列に下線が設定されています。
                - モジュール名のセルをクリックすると、モジュールの変更が行えます。
                - モジュール数のセルをクリックすると、モジュール数の変更が行えます。
                - 兵装可能なモジュールの「編集」セルをクリックすると、兵装編集画面が起動します。
                - 建造方式が複数あるモジュールの「建造方式」セルをクリックすると、一覧から建造方式を選択できます。
                - 兵装可能なモジュールのタレット数とシールド数にカーソルを合わせると、現在の兵装が表示されます。
                - モジュールを選択後右クリックでコピー、貼り付け、削除が可能です。
            - モジュール一覧タブのサブ画面
                1. ジュール選択画面
                    - モジュール種別/所有派閥の一覧のチェック入/切、または「モジュール名を入力して検索」と表示されているテキストボックスに文字列を入力すると、 表示されるモジュールの絞り込みが行えます。
                    - 追加したいモジュールをモジュール一覧より選択し、「選択」ボタンを押すとメイン画面のモジュール一覧に選択されたモジュールが追加されます。
                1. 兵装編集画面
                    - 所有派閥一覧を選択すると、装備一覧の絞り込みが行えます。
                    - 「装備サイズ」コンボボックスで装備の大きさ(中型/大型等)を選択できます。
                    - 装備一覧で装備したい項目を選択し、「→」ボタンを押すとモジュールに選択した項目を装備できます。
                        - 左Shiftを押しながらクリックで選択項目を一気に追加できます。
                    - 「＋」ボタンをクリックすると、現在の装備をもとに、プリセットを作成します。
                    - 「🗑」ボタンをクリックすると、プリセットを削除します。
                    - 「✏」ボタンをクリックすると、プリセットの名前を編集できます。
                    - 「💾」ボタンをクリックすると、プリセットを上書き保存できます。
        1. 概要タブ
            - 「Ⓥ」ボタンを押すと、各項目を展開できます。
            1. 労働力
                1. 必要ウェア情報
                    - 現在の収容人数に対して必要なウェア数を種族ごとに表示します。
                    - 見出しをクリックすると、クリックした項目でソートされます。
                1. モジュール情報
                    - 現在の計画で労働者数を必要または提供するモジュールの一覧を表示します。
                    - 見出しをクリックすると、クリックした項目でソートされます。
            1. 1時間あたりの損益
                - 各製品の1時間あたりの損益を表示します。
                - 見出しをクリックすると、クリックした項目でソートされます。
            1. 建造コスト
                - 建造コストの一覧が表示されます。
                - 見出しをクリックすると、クリックした項目でソートされます。
        1. 製品タブ
            - 左部の「＋」ボタンをクリックすると、製品に関連するモジュールが表示されます。
            - 右クリックメニューから選択した製品に関連するモジュールを一括で表示/非表示可能です。
            - 製品が不足するとセルの背景色が赤くなります。
            - 単価」セルをクリックすると、製品の単価を設定できます。
                - 「単価」セルの右列のスライダーを操作しても同様の操作が行えます。
                - スライダー列の見出し部のスライダーを操作すると、全製品の金額を一括で変更できます。
        1. 建造タブ
            - 「単価」セルをクリックすると、製品の単価を設定できます。
                - 「単価」セルの右列のスライダーを操作しても同様の操作が行えます。
                - スライダー列の見出し部のスライダーを操作すると、全製品の金額を一括で変更できます。
        1. 保管庫タブ
            - 左部の「＋」ボタンをクリックすると、保管庫種別ごとのモジュールが表示されます。
        1. 保管庫割当タブ
            - 上部のスライダーを操作すると、n時間後の保管庫の状況が計算されます。
                - スライダーの最大値はスライダーの右側のテキストボックスで変更できます。
            - ウェアは保管庫種別ごとにグルーピングして表示されます。
                - 「Ⓥ」ボタンをクリックすると、グループの折りたたみ/展開が可能です。
            - 「割当個数」セルは「割当可能個数」セルの値だけ増やすことができます。
            - 指定時間後の個数が負の場合、セルの背景色が赤くなります。
            - 割当個数 < 指定時間後の個数の場合、セルの背景色が黄色になります。

## Tips
- 計画又は、計画エリア内の項目(モジュール一覧等)は自由にドッキング/ドッキング解除できます。


## アンインストール方法
レジストリは一切編集していないのでフォルダごと削除してください。

## Licenses
X4 Complex Calclator is licensed under the [Apache License 2.0](https://github.com/Ocelot1210/X4_ComplexCalculator/blob/master/LICENSE). Contributions are welcomed!